{\rtf1\ansi\ansicpg1250\deff0\deflang1045{\fonttbl{\f0\fnil\fcharset238 Calibri;}{\f1\fnil\fcharset0 Calibri;}{\f2\fswiss\fprq2\fcharset238 Calibri;}{\f3\fswiss\fcharset0 EuroGaramondTTEFN;}}
{\*\generator Msftedit 5.41.21.2510;}\viewkind4\uc1\pard\sa200\sl276\slmult1\f0\fs22 Prolog.\par
Ira\'f1ski program nuklearny od dziesi\'eacioleci pozostawa\'b3 kwesti\'b9 sporn\'b9. Jego oponenci, w tym Stany Zjednoczone, zarzucali Iranowi prowadzenie sekretnych bada\'f1 nad wzbogacaniem uranu - niezb\'eadnym czynnikiem podczas produkcji broni j\'b9drowej. Dla kraj\'f3w pozostaj\'b9cych bez wi\'eakszej wiedzy w tej materii, mo\'bfna stwierdzi\'e6, i\'bf wzbogacanie uranu to skomplikowany, pe\'b3en wyzwa\'f1 proces, wymagaj\'b9cy staranno\'9cci, precyzji oraz niema\'b3ej ilo\'9cci czasu. Jego g\'b3\'f3wnym ogniwem, a zarazem te\'bf najs\'b3abszym punktem s\'b9 wir\'f3wki - urz\'b9dzenia b\'ead\'b9ce metalowymi cylindrami, kt\'f3re potrafi\'b9 si\'ea obraca\'e6 nawet sto tysi\'eacy razy na minut\'ea. Owe wir\'f3wki tworz\'b9 ca\'b3e kompleksy, po\'b3\'b9czone rurami i zaworami. Wprowadzany jest do nich sze\'9cciofluorek uranu - dzi\'eaki bardzo wysokiej pr\'eadko\'9cci wirowania si\'b3a od\'9crodkowa oddziela l\'bfejsze izotopy 235U od izotop\'f3w 238U. W rezultacie mo\'bfna otrzyma\'e6 po\'bf\'b9dany materia\'b3 rozszczepialny spe\'b3niaj\'b9cy kryteria wybuchowej broni masowego ra\'bfenia.\par
W 1999 roku Iran osi\'b9gn\'b9\'b3 sukces w zakresie wytworzenia pierwszych pr\'f3bek uzyskanych podczas test\'f3w wzbogaconego uranu. W rezultacie zatwierdzono plan budowy nowego, specjalistycznego o\'9crodka maj\'b9cego powsta\'e6 w okolicach Natanz, zawieraj\'b9cego tysi\'b9ce wir\'f3wek. W istocie, mia\'b3 by\'e6 to tajny zak\'b3ad wyspecjalizowany w produkcji wzbogacanego uranu, ufortyfikowany oraz zabezpieczony na wz\'f3r obiekt\'f3w wojskowych o wysokim znaczeniu strategicznym. \par
Ten stanowi\'b9cy rozwi\'b9zanie dla jednej z kluczowych barier zwi\'b9zanych z procesem produkcji broni j\'b9drowej zak\'b3ad zosta\'b3 odkryty przez spo\'b3eczno\'9c\'e6 mi\'eadzynarodow\'b9, co spowodowa\'b3o zaostrzenie i tak ju\'bf napi\'eatych stosunk\'f3w dyplomatycznych Iranu z grup\'b9 kraj\'f3w sprzeciwiaj\'b9cych si\'ea do\'b3\'b9czeniu nowego gracza do klubu posiadaczy arsena\'b3\'f3w broni j\'b9drowej. Stany Zjednoczone, w poczuciu zagro\'bfenia interes\'f3w w\'b3asnych i sojuszniczych na Bliskim Wschodzie, podj\'ea\'b3y niezb\'eadne (w ich przekonaniu) \'9crodki zaradcze. \par
\lang1033\f1\par
\lang1045\f0 Pierwsze spotkanie.\par
W czerwcu 2010 roku Siergiej Ulasen, szef wydzia\'b3u antywirusowej cz\'ea\'9cci bia\'b3oruskiej firmy VirusBlokAda wraz ze swym zespo\'b3em odkryli tajemnicze pliki z pewnego zainfekowanego komputera z Iranu. Po wst\'eapnych badaniach okaza\'b3o si\'ea, i\'bf natrafili na wirusa sk\'b3adaj\'b9cego si\'ea z dw\'f3ch element\'f3w: tak zwanych \i exploit \i0 - cz\'ea\'9cci odpowiedzialnej za wprowadzenie wirusa do systemu operacyjnego - oraz \i rootkit\i0  - cz\'ea\'9cci odpowiedzialnej za ukrycie wirusa przed programami antywirusowymi.\par
Wspomniany \i exploit \i0 wykorzystuje luki w zabezpieczeniach aplikacji i przegl\'b9darek, jednak jego szczeg\'f3lnie cenn\'b9 odmian\'b9 jest tzw. \i exploit zero-day\i0  - cenn\'b9, poniewa\'bf korzysta on z tych dziur, kt\'f3re nie s\'b9 znane producentom oprogramowania antywirusowego, przez co gwarantuje on niejako niewidzialno\'9c\'e6 dla zabezpieczanej przez niego zawarto\'9cci. \par
Kiedy okaza\'b3o si\'ea, i\'bf badany przez zesp\'f3\'b3 wirus zawiera w sobie t\'ea drogocenn\'b9 odmian\'ea \i exploit\i0 , Ulasen, po otrzymaniu dost\'eapu do zainfekowanego komputera postanowi\'b3 pobra\'e6 podejrzane pliki do maszyny testowej. Ku jego zdumieniu, wirus instalowa\'b3 si\'ea niezauwa\'bfalnie w systemie - wskazywa\'b3o to na budz\'b9cy s\'b3uszne obawy fakt, i\'bf szkodliwe pliki mog\'b3y zosta\'e6 podpisane przez prawid\'b3owy certyfikat cyfrowy. \par
Stuxnet - tak si\'ea nazywa\'b3 \'f3w tajemniczy wirus kr\'b9\'bf\'b9cy po sieci - zosta\'b3 podpisany za pomoc\'b9 certyfikatu firmy JMicron Technology, tajwa\'f1skiego producenta uk\'b3ad\'f3w scalonych. Sprawa zaczyna wydawa\'e6 si\'ea precedensem - certyfikaty cyfrowe, b\'ead\'b9ce swego rodzaju po\'9cwiadczeniem w w wirtualnej rzeczywisto\'9cci, \'bfe dany obiekt jest bezpieczny i godny zaufania, za spraw\'b9 Stuxnetu okaza\'b3y si\'ea budzi\'e6 w\'b9tpliwo\'9cci co do ich wiarygodno\'9cci. W obliczu nabieraj\'b9cej powagi, rozwojowej sprawy, Ulasen i jego zesp\'f3\'b3 postanowili przes\'b3a\'e6 pliki do firmy Symantec, specjalist\'f3w w zakresie analiz potencjalnie szkodliwego oprogramowania.\lang1033\f1\par
\par
\lang1045\f0 Analiza budowy wirusa Stuxnet\par
Po odpakowaniu wierzchniej warstwy wirusa specjali\'9cci z firmy Symantec stwierdzili, i\'bf wirus atakowa\'b3 tylko komputery maj\'b9ce zainstalowane oprogramowanie s\'b3u\'bf\'b9ce do wsp\'f3\'b3pracy ze sterownikami PLC firmy Siemens, kt\'f3re z kolei zarz\'b9dzaj\'b9 prac\'b9 minikomputer\'f3w w fabrykach i o\'9crodkach przemys\'b3owych. Ju\'bf na pocz\'b9tku analizy okaza\'b3o si\'ea, \'bfe badany wirus ma bardzo skomplikowan\'b9 struktur\'ea oraz niespotykanie du\'bfy (jak na wirusa) rozmiar - g\'b3\'f3wny plik zajmowa\'b3 ok. 500 kilobajt\'f3w, a po dekompresji i odpakowaniu z pierwszej warstwy przesz\'b3o 1 megabajt. Zawiera\'b3 r\'f3wnie\'bf kilka poziom\'f3w szyfrowania rozcz\'b3onkowanych fragment\'f3w kodu oraz bardzo specyficzn\'b9 struktur\'ea g\'b3\'f3wnego pliku. \par
Rdze\'f1 wirusa to plik z rozszerzeniem bibliotecznym .dll, kt\'f3ry zawiera\'b3 w sobie kolejny plik biblioteczny, a ten w \'9crodku jeszcze nast\'eapny, i tak a\'bf trzydzie\'9cci razy, tworz\'b9c w ten spos\'f3b wielopoziomow\'b9, zaszyfrowan\'b9 struktur\'ea. Jak si\'ea okaza\'b3o w trakcie p\'f3\'9fniejszej analizy, tego typu zabieg by\'b3 nieprzypadkowy - wirus atakowa\'b3 tylko te komputery, kt\'f3re spe\'b3nia\'b3y jego w\'b9sk\'b9, wyspecjalizowan\'b9 specyfikacj\'ea. W miar\'ea spe\'b3niania kolejnych warunk\'f3w, kod odszyfrowywa\'b3 swoj\'b9 zawarto\'9c\'e6, jednak w momencie, gdy kt\'f3ry\'9c z nich nie zosta\'b3 spe\'b3niony, ko\'f1czy\'b3 dzia\'b3anie bez szkody dla zainfekowanego komputera.\par
Uwag\'ea specjalist\'f3w przyku\'b3 r\'f3wnie\'bf d\'b3ugi plik konfiguracyjny - Stuxnet zawiera\'b3 du\'bf\'b9 liczb\'ea adres\'f3w serwer\'f3w, z kt\'f3rymi si\'ea komunikowa\'b3, oraz informacje, kt\'f3re przez nie przekazywa\'b3 - m.in liczb\'ea zainfekowanych komputer\'f3w. Jednak szczeg\'f3ln\'b9 uwag\'ea badaczy przyku\'b3 wysublimowany spos\'f3b uruchamiania kodu wirusa.\par
Problem zwi\'b9zany z uruchomieniem wirusa wynika z faktu, i\'bf kod musi zosta\'e6 umieszczony przez system w pami\'eaci operacyjnej, aby m\'f3g\'b3 by\'e6 wykonany. Jednak\'bfe programy antywirusowe potrafi\'b9 wykry\'e6 tego typu dzia\'b3alno\'9c\'e6 podczas monitorowania pracy systemu, jednak tw\'f3rcy Stuxneta wymy\'9clili nietuzinkowe rozwi\'b9zanie. Jak to zgrabnie uj\'b9\'b3 autor ksi\'b9\'bfki pt. "Odliczaj\'b9c do dnia zero. Stuxnet, czyli prawdziwa historia cyfrowej broni":\par
\pard\i\f2 "(...)Stuxnet ca\'b3y potrzebny kod zawiera\'b3 w sobie, przechowuj\'b9c go w wirtualnych plikach o specjalnych nazwach.Standardowo takie rozwi\'b9zanie nie powinno zadzia\'b3a\'e6, poniewa\'bf\par
w momencie wywo\'b3ania kodu przez Stuxneta system operacyjny nie rozpozna\'b3by\par
nazw lub szuka\'b3by na dysku nieistniej\'b9cych plik\'f3w o dziwnych nazwach. Jednak Stuxnet \'84zwi\'f3d\'b3\rdblquote  (przeprogramowa\'b3) cz\'ea\'9c\'e6 interfejsu API systemu Windows (jest to interfejs mi\'eadzy systemem operacyjnym a dzia\'b3aj\'b9cymi w nim programami) w taki spos\'f3b, \'bfe po wywo\'b3aniu plik\'f3w o dziwnych nazwach system operacyjny zwraca\'b3 si\'ea do dost\'eapnego w pami\'eaci Stuxneta i pobiera\'b3 od niego kod. Stuxnet by\'b3 te\'bf przygotowany na to, \'bfe program antywirusowy podejrzliwie potraktuje pliki z pami\'eaci i spr\'f3buje je zbada\'e6. Poniewa\'bf robak kontrolowa\'b3 fragmenty interfejsu API systemu Windows odpowiedzialne za okre\'9clanie atrybut\'f3w plik\'f3w, potrafi\'b3 przekona\'e6 skaner, \'bfe pliki te s\'b9 puste. By\'b3a to informacja: \'84Nie ma tu czego ogl\'b9da\'e6, prosz\'ea i\'9c\'e6 dalej(...)\rdblquote .\lang1033\f1\par
\pard\sa200\sl276\slmult1\i0\par
\lang1045\f0 W momencie, gdy wirus stwierdza\'b3, i\'bf nie znalaz\'b3 w systemie w\'b3a\'9cciwego oprogramowania Siemensa, ko\'f1czy\'b3 prac\'ea. Co ciekawe, specjali\'9cci odnale\'9fli w kodzie wirusa dat\'ea jego ko\'f1ca dzia\'b3ania - gdyby czas systemowy komputera przekroczy\'b3 dat\'ea 24 czerwca 2012 roku, w\'f3wczas wirus by nie podejmowa\'b3 pr\'f3b infekcji. Mia\'b3 r\'f3wnie\'bf wszczepiony zaw\'f3r bezpiecze\'f1stwa w postaci specjalnego \'b3a\'f1cucha znak\'f3w w rejestrze systemowym - je\'9cli w rejestrze odnalaz\'b3 \'b3a\'f1cuch "\lang1033\f3\fs21 0x19790509\lang1045\f0 ", w\'f3wczas nie atakowa\'b3.\fs22\par
Po zbadaniu adres\'f3w stron, na kt\'f3re Stuxnet przesy\'b3a\'b3 informacje, specjali\'9cci poprosili o przekierowanie historii ruchu dostawc\'f3w internetu z tych stron.\f2\fs21  Dzieki temu mogli zaobserwowac nietypowa koncentracje przychodzacych polaczen w Iranie. Na 38 tys namierzonych komputerow az 22 tys znajdowalo si\'ea w Iranie.\par
\par
\f0\fs22 Stuxnet - jego cel oraz zasada dzia\'b3ania.\par
Po kilkumiesi\'eacznych analizach zesp\'f3\'b3 specjalist\'f3w badaj\'b9cych Stuxneta stwierdzi\'b3, \'bfe celem wirusa by\'b3 fizyczny sabota\'bf sterownik\'f3w PLC Siemensa. Ustalono r\'f3wnie\'bf, \'bfe cho\'e6 infekowa\'b3 wiele komputer\'f3w, to sw\'f3j kod wykonywa\'b3 jedynie na komputerach w tajnym o\'9crodku wzbogacania uranu w Iranie w Natanz, przy czym by\'b3y to tylko te komputery, kt\'f3rych sterownik PLC zarz\'b9dza\'b3 konkretnymi modelami falownik\'f3w - konwerter\'f3w cz\'eastotliwo\'9cci - u\'bfywanych w wir\'f3wkach w zak\'b3adzie. Robi\'b3 to w spos\'f3b nast\'eapuj\'b9cy: \par
- Wirus zast\'eapowa\'b3 plik .dll Siemensa sobowt\'f3rem, zmieniaj\'b9c jego nazw\'ea. W ten spos\'f3b, gdy system wywo\'b3ywa\'b3 plik .dll Siemensa podczas pracy, wywo\'b3ywa\'b3 szkodliwy sobowt\'f3r.\par
- Nast\'eapnie zwi\'eaksza\'b3 wielko\'9c\'e6 bloku w kodzie sterownika, aby doda\'e6 w\'b3asne instrukcje z gwarancj\'b9, \'bfe nie ryzykuje wywo\'b3ania b\'b3\'eadu poprzez przekroczenie dopuszczalnego rozmiaru rezerwowanej pami\'eaci, a co za tym idzie, unieruchomienia pracy sterownika.\par
- Pocz\'b9tkowa faza dzia\'b3ania wirusa przebiega\'b3a w bardzo pomys\'b3owy spos\'f3b. Wirus przez pierwsze dwa tygodnie dzia\'b3ania jedynie rejestrowa\'b3 w sterowniku poprawne operacje, gdy sterownik przesy\'b3a\'b3 raporty do stacji monitoruj\'b9cych. Materia\'b3y te wykorzystywa\'b3 w swojej p\'f3\'9fniejszej, faktycznej fazie dzia\'b3ania, przesy\'b3aj\'b9c je operatorom, aby ukry\'e6 przed nimi, \'bfe dzieje si\'ea co\'9c z\'b3ego.\par
- W kolejnej fazie Stuxnet wy\'b3\'b9cza\'b3 wszystkie alarmy cyfrowe, modyfikuj\'b9c bloki kodu OB35, odpowiedzialnych za system bezpiecze\'f1stwa sterownik\'f3w PLC Siemensa. Przewidzia\'b3 r\'f3wnie\'bf mo\'bfliwo\'9c\'e6 interwencji programist\'f3w w wypadku problem\'f3w, kt\'f3rzy mogliby zarzada\'e6 dost\'eapu do blok\'f3w kodu - w\'f3wczas wirus by\'b3by w stanie przechwytywa\'e6 wszystkie ich \'bf\'b9dania i zwraca\'b3 pierwotn\'b9 wersj\'ea kodu, bez swoich szkodliwych polece\'f1.\par
- Nast\'eapnie przechodzi\'b3 do faktycznego dzia\'b3ania. Wstrzykiwa\'b3 szkodliwy kod do tak zwanego schematu drabinkowego sterownika - jego cz\'ea\'9cci odpowiedzialnej za przesy\'b3anie polece\'f1 zawieraj\'b9cych m.in. warto\'9cci cz\'eastotliwo\'9cci do falownika. To w\'b3a\'9cnie te warto\'9cci wirus modyfikowa\'b3 w celu zepsucia ca\'b3ej wir\'f3wki. Robi\'b3 to jednak w spos\'f3b inteligentny - pojedy\'f1czy sabota\'bf trwa\'b3 nie d\'b3u\'bfej ni\'bf 15 minut, a odchylone warto\'9cci zosta\'b3y dobrane tak, aby falownik swoj\'b9 niew\'b3a\'9cciw\'b9 prac\'b9 stopniowo uszkadza\'b3 wir\'f3wki, a nie psu\'b3 je od razu. Wszystko to w celu zapewnienia jak najwi\'eakszej dyskrecji i zminimalizowania jakiegokolwiek wykrycia \'9cladu dzia\'b3ania wirusa. \par
Stuxnet dzia\'b3a\'b3 na falownik dwufazowo - najpierw zwi\'eaksza\'b3 warto\'9c\'e6 cz\'eastotliwo\'9cci do 1410 Hz, a nast\'eapnie zmniejsza\'b3 j\'b9 do 1064 Hz. Tworzy\'b3 w ten spos\'f3b cykl sk\'b3adaj\'b9cy si\'ea odpowiednio z fazy 15 minutowej (zwi\'eakszenie warto\'9cci) i 26 dniowej (przywr\'f3cenie standardowej warto\'9cci). Dodatkowo, w pojedynczym ataku wirus raz gwa\'b3townie zmniejsza\'b3 cz\'eastotliwo\'9c\'e6 do 2 Hz, po czym ponownie przywraca\'b3 poprawn\'b9 warto\'9c\'e6. \par
Poza powy\'bfej opisanym atakiem na model sterownika PLC 315, kt\'f3ry odpowiada\'b3 za prac\'ea falownika, wirus atakowa\'b3 r\'f3wnie\'bf model sterownika PLC 417. Cho\'e6 nie ustalono dok\'b3adnie, co by\'b3o konkretnie celem ataku (kod ten nigdy nie zosta\'b3 wykonany), przypuszczano, \'bfe w tym ataku celem mia\'b3y by\'e6 zawory znajduj\'b9ce si\'ea w instalacji gazu wir\'f3wek. Szkodliwy kod, zamiast zmienia\'e6 cz\'eastotliwo\'9cci, mia\'b3by tylko wy\'b3\'b9cza\'e6 i w\'b3\'b9cza\'e6 urz\'b9dzenia - bior\'b9c jednak pod uwag\'ea newralgiczn\'b9 cz\'ea\'9c\'e6 instalacji, wszelkie niekorzystne zmiany w regulacji dop\'b3ywu gazu do instalacji mog\'b3yby mie\'e6 druzgoc\'b9ce skutki w postaci niekontrolowanych eksplozji. \par
Stuxnet, cho\'e6 mistrzowsko zabezpieczony pod wzgl\'eadem wykrycia, uleg\'b3 zewn\'eatrznym si\'b3om w postaci nacisk\'f3w politycznych. Ze wzgl\'eadu na zaostrzaj\'b9c\'b9 si\'ea sytuacj\'ea polityczn\'b9, tw\'f3rcy wirusa postanowili zwi\'eakszy\'e6 jego si\'b3\'ea ra\'bfenia. W konsekwencji dosz\'b3o do niekontrolowanego rozprzestrzenienia si\'ea wirusa w sieci, co doprowadzi\'b3o do jego wykrycia i rozpracowania.\par
\lang1033\f1\par
\lang1045\f0 Konsekwencje wirusa Stuxnet dla militarnego \'9cwiata cyberbroni - podsumowanie\par
\lang1033\f1\par
\lang1045\f0 Pierwsze wzmianki o u\'bfyciu cyberbroni wskazuj\'b9 na 1982 rok. Cho\'e6 nie udowodniono prawdziwo\'9cci nast\'eapuj\'b9cej historii, opowiada ona o spisku uknutym przez CIA w celu wysadzenia rosyjskiego gazoci\'b9gu. Cyfrowa bomba w postaci szkodliwego kodu wstrzykni\'eatego do oprogramowania steruj\'b9cego gazoci\'b9giem mia\'b3a spowodowa\'e6 pot\'ea\'bfn\'b9 eksplozj\'ea spowodowan\'b9 b\'b3\'eadnym funkcjonowaniem zawor\'f3w gazoci\'b9gu.\par
Stuxnet jest pierwszym, w pe\'b3ni udokumentowanym przypadkiem w historii wirtualnego ataku o fizycznych skutkach na szersz\'b9 skal\'ea. Cho\'e6 nie zatrzyma\'b3 ira\'f1skiego programu nuklearnego, na pewno przyczyni\'b3 si\'ea do jego spowolnienia. Wbrew tw\'f3rcom Stuxneta, jego kod zosta\'b3 udost\'eapniony - dzi\'eaki temu przyszli i obecni konstruktorzy cyberbroni zyskali punkt odniesienia dla swoich przysz\'b3ych dzie\'b3. Mog\'b9 r\'f3wnie\'bf wyci\'b9ga\'e6 wnioski z mocnych i s\'b3abych stron wirusa, aby unika\'e6 w przysz\'b3o\'9cci b\'b3\'ead\'f3w pope\'b3nionych przez jego tw\'f3rc\'f3w.\lang1033\f1\par
}
 